<div class="container-fluid animated fadeIn">
  <app-error-success
    *ngIf="failedToGetProductAlert"
    [data]="failedToGetProductAlertInfo"
    (close)="failedToGetProductAlert = !failedToGetProductAlert"
  >
  </app-error-success>
  <div *ngIf="productDetail">
    <form [formGroup]="addBatchForm" (ngSubmit)="addBatchInfo()">
      <h1>Add Batch</h1>
      <div class="row mb-3">
        <div class="col-12 col-md-6">
          <span class="h5">Product : {{ productDetail.name }}</span>
        </div>
        <div class="col-12 col-md-6">
          <span class="h5">Company : {{ productDetail.company.name }}</span>
        </div>
      </div>

      <div class="form-group row">
        <label for="batch-number" class="col-sm-2 col-form-label"
          >Batch Number</label
        >
        <div class="col-sm-10">
          <input
            type="text"
            class="form-control text-uppercase"
            [class.is-invalid]="
              addBatchForm.get('batchNumber')?.invalid &&
              addBatchForm.get('batchNumber')?.touched
            "
            id="batch-number"
            placeholder="Batch Number"
            formControlName="batchNumber"
          />
          <small
            [class.d-none]="
              addBatchForm.get('batchNumber')?.valid ||
              addBatchForm.get('batchNumber')?.untouched
            "
            class="text-danger"
          >
            Batch number is required
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="purchaseQuantity" class="col-sm-2 col-form-label"
          >Purchase Quantity</label
        >
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('purchaseQuantity')?.invalid &&
              addBatchForm.get('purchaseQuantity')?.touched
            "
            id="purchaseQuantity"
            placeholder="purchaseQuantity"
            formControlName="purchaseQuantity"
          />
          <small
            [class.d-none]="
              addBatchForm.get('purchaseQuantity')?.valid ||
              addBatchForm.get('purchaseQuantity')?.untouched
            "
            class="text-danger"
          >
            Purchase quantity is invalid
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="saleQuantity" class="col-sm-2 col-form-label"
          >Sale quantity</label
        >
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('saleQuantity')?.invalid &&
              addBatchForm.get('saleQuantity')?.touched
            "
            id="saleQuantity"
            placeholder="Sale Quantity"
            formControlName="saleQuantity"
            (focusout)="calculateTaxAndPrices()"
          />
          <small
            [class.d-none]="
              addBatchForm.get('saleQuantity')?.valid ||
              addBatchForm.get('saleQuantity')?.untouched
            "
            class="text-danger"
          >
            Sale quantity is required
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="purchaseRate" class="col-sm-2 col-form-label"
          >Purchase Rate</label
        >
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('purchaseRate')?.invalid &&
              addBatchForm.get('purchaseRate')?.touched
            "
            id="purchaseRate"
            placeholder="Purchase Rate"
            formControlName="purchaseRate"
            (focusout)="calculateTaxAndPrices()"
          />
          <small
            [class.d-none]="
              addBatchForm.get('purchaseRate')?.valid ||
              addBatchForm.get('purchaseRate')?.untouched
            "
            class="text-danger"
          >
            Purchase rate is required
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="saleRate" class="col-sm-2 col-form-label">Sale Rate</label>
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('saleRate')?.invalid &&
              addBatchForm.get('saleRate')?.touched
            "
            id="saleRate"
            placeholder="Sale Rate"
            formControlName="saleRate"
          />
          <small
            [class.d-none]="
              addBatchForm.get('saleRate')?.valid ||
              addBatchForm.get('saleRate')?.untouched
            "
            class="text-danger"
          >
            Sale Rate is required
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="mrp" class="col-sm-2 col-form-label">MRP</label>
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('mrp')?.invalid &&
              addBatchForm.get('mrp')?.touched
            "
            id="mrp"
            placeholder="MRP"
            formControlName="mrp"
          />
          <small
            [class.d-none]="
              addBatchForm.get('mrp')?.valid ||
              addBatchForm.get('mrp')?.untouched
            "
            class="text-danger"
          >
            MRP is required
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="discountPercent" class="col-sm-2 col-form-label"
          >Discount %</label
        >
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('discountPercent')?.invalid &&
              addBatchForm.get('discountPercent')?.touched
            "
            id="discountPercent"
            placeholder="Discount %"
            formControlName="discountPercent"
          />
        </div>
      </div>
      <div class="form-group row">
        <label for="expirydate" class="col-sm-2 col-form-label"
          >Expiry Date</label
        >
        <div class="col-sm-10">
          <input
            type="text"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('expirydate')?.invalid &&
              addBatchForm.get('expirydate')?.touched
            "
            id="expirydate"
            placeholder="ExpiryDate"
            formControlName="expirydate"
          />
          <small
            [class.d-none]="
              addBatchForm.get('expirydate')?.valid ||
              addBatchForm.get('expirydate')?.untouched
            "
            class="text-danger"
          >
            Expirydate is required
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="opQuantity" class="col-sm-2 col-form-label"
          >Op quantity</label
        >
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('opQuantity')?.invalid &&
              addBatchForm.get('opQuantity')?.touched
            "
            id="opQuantity"
            placeholder="OP Quantity"
            formControlName="opQuantity"
          />
        </div>
      </div>
      <div class="form-group row">
        <label for="cgstPercent" class="col-sm-2 col-form-label">CGST %</label>
        <div class="col-sm-10">
          <input
            type="text"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('cgstPercent')?.invalid &&
              addBatchForm.get('cgstPercent')?.touched
            "
            id="cgstPercent"
            placeholder="cgstPercent"
            formControlName="cgstPercent"
            (focusout)="calculateTaxAndPrices()"
          />
          <small
            [class.d-none]="
              addBatchForm.get('cgstPercent')?.valid ||
              addBatchForm.get('cgstPercent')?.untouched
            "
            class="text-danger"
          >
            CGST % is required
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="sgstPercent" class="col-sm-2 col-form-label">SGST %</label>
        <div class="col-sm-10">
          <input
            type="text"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('sgstPercent')?.invalid &&
              addBatchForm.get('sgstPercent')?.touched
            "
            id="sgstPercent"
            placeholder="sgstPercent"
            formControlName="sgstPercent"
            (focusout)="calculateTaxAndPrices()"
          />
          <small
            [class.d-none]="
              addBatchForm.get('sgstPercent')?.valid ||
              addBatchForm.get('sgstPercent')?.untouched
            "
            class="text-danger"
          >
            SGST % is required
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="igstPercent" class="col-sm-2 col-form-label">IGST %</label>
        <div class="col-sm-10">
          <input
            type="text"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('igstPercent')?.invalid &&
              addBatchForm.get('igstPercent')?.touched
            "
            id="igstPercent"
            placeholder="igstPercent"
            formControlName="igstPercent"
            (focusout)="calculateTaxAndPrices()"
          />
          <small
            [class.d-none]="
              addBatchForm.get('igstPercent')?.valid ||
              addBatchForm.get('igstPercent')?.untouched
            "
            class="text-danger"
          >
            IGST % is required
          </small>
        </div>
      </div>

      <div class="form-group row">
        <div class="col-sm-10">
          <app-error-success
            *ngIf="addBatchAlerts.failedToAddBatch"
            [data]="addBatchFailureInfo"
            (close)="
              addBatchAlerts.failedToAddBatch = !addBatchAlerts.failedToAddBatch
            "
          >
          </app-error-success>
          <app-error-success
            *ngIf="addBatchAlerts.batchAdded"
            [data]="addBatchSuccessInfo"
            (close)="addBatchAlerts.batchAdded = !addBatchAlerts.batchAdded"
          >
          </app-error-success>
          <app-loader
            *ngIf="addBatchInfoLoader"
            [data]="{ type: 'full' }"
          ></app-loader>
          <button type="submit" class="btn btn-primary">Add batch</button>
        </div>
      </div>
    </form>
  </div>
</div>

<ng-container>
  <app-loader
    *ngIf="getProductDetailLoader"
    [data]="{ type: 'full' }"
  ></app-loader>
</ng-container>
