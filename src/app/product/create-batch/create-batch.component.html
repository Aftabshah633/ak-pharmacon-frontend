<div class="container-fluid animated fadeIn">
  <app-error-success
    *ngIf="failedToGetProductAlert"
    [data]="failedToGetProductAlertInfo"
    (close)="failedToGetProductAlert = !failedToGetProductAlert"
  >
  </app-error-success>
  <div *ngIf="productDetail">
    <form [formGroup]="addBatchForm" (ngSubmit)="addBatchInfo()">
      <h1>Add Batch</h1>
      <div class="row mb-3">
        <div class="col-12 col-md-6">
          <span class="h5">Product : {{ productDetail.name }}</span>
        </div>
        <div class="col-12 col-md-6">
          <span class="h5">Company : {{ productDetail.company.name }}</span>
        </div>
      </div>

      <div class="form-group row">
        <label for="batch-number" class="col-sm-2 col-form-label"
          >Batch Number</label
        >
        <div class="col-sm-10">
          <input
            type="text"
            class="form-control text-uppercase"
            [class.is-invalid]="
              addBatchForm.get('batchNumber')?.invalid &&
              addBatchForm.get('batchNumber')?.touched
            "
            id="batch-number"
            placeholder="Batch Number"
            formControlName="batchNumber"
          />
          <small
            [class.d-none]="
              addBatchForm.get('batchNumber')?.valid ||
              addBatchForm.get('batchNumber')?.untouched
            "
            class="text-danger"
          >
            Batch number is required
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="purchaseQuantity" class="col-sm-2 col-form-label"
          >Purchase Quantity</label
        >
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('purchaseQuantity')?.invalid &&
              addBatchForm.get('purchaseQuantity')?.touched
            "
            id="purchaseQuantity"
            placeholder="purchaseQuantity"
            formControlName="purchaseQuantity"
          />
          <small
            [class.d-none]="
              addBatchForm.get('purchaseQuantity')?.valid ||
              addBatchForm.get('purchaseQuantity')?.untouched
            "
            class="text-danger"
          >
            Purchase quantity is invalid
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="saleQuantity" class="col-sm-2 col-form-label"
          >Sale quantity</label
        >
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('saleQuantity')?.invalid &&
              addBatchForm.get('saleQuantity')?.touched
            "
            id="saleQuantity"
            placeholder="Sale Quantity"
            formControlName="saleQuantity"
            (focusout)="calculateTaxAndPrices()"
          />
          <small
            [class.d-none]="
              addBatchForm.get('saleQuantity')?.valid ||
              addBatchForm.get('saleQuantity')?.untouched
            "
            class="text-danger"
          >
            Sale quantity is required
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="purchaseRate" class="col-sm-2 col-form-label"
          >Purchase Rate</label
        >
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('purchaseRate')?.invalid &&
              addBatchForm.get('purchaseRate')?.touched
            "
            id="purchaseRate"
            placeholder="Purchase Rate"
            formControlName="purchaseRate"
            (focusout)="calculateTaxAndPrices()"
          />
          <small
            [class.d-none]="
              addBatchForm.get('purchaseRate')?.valid ||
              addBatchForm.get('purchaseRate')?.untouched
            "
            class="text-danger"
          >
            Purchase rate is required
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="saleRate" class="col-sm-2 col-form-label">Sale Rate</label>
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('saleRate')?.invalid &&
              addBatchForm.get('saleRate')?.touched
            "
            id="saleRate"
            placeholder="Sale Rate"
            formControlName="saleRate"
          />
          <small
            [class.d-none]="
              addBatchForm.get('saleRate')?.valid ||
              addBatchForm.get('saleRate')?.untouched
            "
            class="text-danger"
          >
            Sale Rate is required
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="mrp" class="col-sm-2 col-form-label">MRP</label>
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('mrp')?.invalid &&
              addBatchForm.get('mrp')?.touched
            "
            id="mrp"
            placeholder="MRP"
            formControlName="mrp"
          />
          <small
            [class.d-none]="
              addBatchForm.get('mrp')?.valid ||
              addBatchForm.get('mrp')?.untouched
            "
            class="text-danger"
          >
            MRP is required
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="discountPercent" class="col-sm-2 col-form-label"
          >Discount %</label
        >
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('discountPercent')?.invalid &&
              addBatchForm.get('discountPercent')?.touched
            "
            id="discountPercent"
            placeholder="Discount %"
            formControlName="discountPercent"
          />
        </div>
      </div>
      <div class="form-group row">
        <label for="expirydate" class="col-sm-2 col-form-label"
          >Expiry Date</label
        >
        <div class="col-sm-10">
          <input
            type="text"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('expirydate')?.invalid &&
              addBatchForm.get('expirydate')?.touched
            "
            id="expirydate"
            placeholder="ExpiryDate"
            formControlName="expirydate"
          />
          <small
            [class.d-none]="
              addBatchForm.get('expirydate')?.valid ||
              addBatchForm.get('expirydate')?.untouched
            "
            class="text-danger"
          >
            Expirydate is required
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="opQuantity" class="col-sm-2 col-form-label"
          >Op quantity</label
        >
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('opQuantity')?.invalid &&
              addBatchForm.get('opQuantity')?.touched
            "
            id="opQuantity"
            placeholder="OP Quantity"
            formControlName="opQuantity"
          />
        </div>
      </div>

      <div class="form-group row">
        <label for="purchaseCgstPercent" class="col-sm-2 col-form-label"
          >Purchase CGST %</label
        >
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('purchaseCgstPercent')?.invalid &&
              addBatchForm.get('purchaseCgstPercent')?.touched
            "
            id="purchaseCgstPercent"
            placeholder="purchaseCgstPercent"
            formControlName="purchaseCgstPercent"
            (focusout)="calculateTaxAndPrices()"
          />
          <small
            [class.d-none]="
              addBatchForm.get('purchaseCgstPercent')?.valid ||
              addBatchForm.get('purchaseCgstPercent')?.untouched
            "
            class="text-danger"
          >
            Purchase CGST % is required
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="purchaseSgstPercent" class="col-sm-2 col-form-label">Purchase SGST %</label>
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('purchaseSgstPercent')?.invalid &&
              addBatchForm.get('purchaseSgstPercent')?.touched
            "
            id="purchaseSgstPercent"
            placeholder="purchaseSgstPercent"
            formControlName="purchaseSgstPercent"
            (focusout)="calculateTaxAndPrices()"
          />
          <small
            [class.d-none]="
              addBatchForm.get('purchaseSgstPercent')?.valid ||
              addBatchForm.get('purchaseSgstPercent')?.untouched
            "
            class="text-danger"
          >
            Purchase SGST % is required
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="purchaseIgstPercent" class="col-sm-2 col-form-label">Purchase IGST %</label>
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('purchaseIgstPercent')?.invalid &&
              addBatchForm.get('purchaseIgstPercent')?.touched
            "
            id="purchaseIgstPercent"
            placeholder="purchaseIgstPercent"
            formControlName="purchaseIgstPercent"
            (focusout)="calculateTaxAndPrices()"
          />
          <small
            [class.d-none]="
              addBatchForm.get('purchaseIgstPercent')?.valid ||
              addBatchForm.get('purchaseIgstPercent')?.untouched
            "
            class="text-danger"
          >
            Purchase IGST % is required
          </small>
        </div>
      </div>

      <div class="form-group row">
        <label for="saleCgstPercent" class="col-sm-2 col-form-label"
          >Sale CGST %</label
        >
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('saleCgstPercent')?.invalid &&
              addBatchForm.get('saleCgstPercent')?.touched
            "
            id="saleCgstPercent"
            placeholder="saleCgstPercent"
            formControlName="saleCgstPercent"
          />
          <small
            [class.d-none]="
              addBatchForm.get('saleCgstPercent')?.valid ||
              addBatchForm.get('saleCgstPercent')?.untouched
            "
            class="text-danger"
          >
            Sale CGST % is required
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="saleSgstPercent" class="col-sm-2 col-form-label"
          >Sale SGST %</label
        >
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('saleSgstPercent')?.invalid &&
              addBatchForm.get('saleSgstPercent')?.touched
            "
            id="saleSgstPercent"
            placeholder="saleSgstPercent"
            formControlName="saleSgstPercent"
          />
          <small
            [class.d-none]="
              addBatchForm.get('saleSgstPercent')?.valid ||
              addBatchForm.get('saleSgstPercent')?.untouched
            "
            class="text-danger"
          >
            Sale SGST % is required
          </small>
        </div>
      </div>
      <div class="form-group row">
        <label for="saleIgstPercent" class="col-sm-2 col-form-label">
          Sale IGST %</label
        >
        <div class="col-sm-10">
          <input
            type="number"
            class="form-control"
            [class.is-invalid]="
              addBatchForm.get('saleIgstPercent')?.invalid &&
              addBatchForm.get('saleIgstPercent')?.touched
            "
            id="saleIgstPercent"
            placeholder="saleIgstPercent"
            formControlName="saleIgstPercent"
          />
          <small
            [class.d-none]="
              addBatchForm.get('saleIgstPercent')?.valid ||
              addBatchForm.get('saleIgstPercent')?.untouched
            "
            class="text-danger"
          >
            Sale IGST % is required
          </small>
        </div>
      </div>

      <div class="form-group row">
        <div class="col-sm-10">
          <app-error-success
            *ngIf="addBatchAlerts.failedToAddBatch"
            [data]="addBatchFailureInfo"
            (close)="
              addBatchAlerts.failedToAddBatch = !addBatchAlerts.failedToAddBatch
            "
          >
          </app-error-success>
          <app-error-success
            *ngIf="addBatchAlerts.batchAdded"
            [data]="addBatchSuccessInfo"
            (close)="addBatchAlerts.batchAdded = !addBatchAlerts.batchAdded"
          >
          </app-error-success>
          <app-loader
            *ngIf="addBatchInfoLoader"
            [data]="{ type: 'full' }"
          ></app-loader>
          <button type="submit" class="btn btn-primary">Add batch</button>
        </div>
      </div>
    </form>
  </div>
</div>

<ng-container>
  <app-loader
    *ngIf="getProductDetailLoader"
    [data]="{ type: 'full' }"
  ></app-loader>
</ng-container>
